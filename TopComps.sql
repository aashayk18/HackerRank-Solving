select hacker_id, name from( select *, case when score = tot_score then 1 else 0 end as Flag from ( select s.submission_id, s.hacker_id, h.name, s.challenge_id, c.difficulty_level, s.score, d.score as tot_score from Submissions s left join Hackers h on s.hacker_id = h.hacker_id left join Challenges c on c.challenge_id = s.challenge_id left join Difficulty d on d.difficulty_level = c.difficulty_level) as t1 ) as t2 group by hacker_id, name having sum(Flag)>1 order by sum(Flag) desc, hacker_id asc;